var EpsilonFramework="undefined"==typeof EpsilonFramework?{}:EpsilonFramework;EpsilonFramework.repeater="undefined"==typeof EpsilonFramework.repeater?{}:EpsilonFramework.repeater,EpsilonFramework.sectionRepeater="undefined"==typeof EpsilonFramework.sectionRepeater?{}:EpsilonFramework.sectionRepeater,EpsilonFramework.colorSchemes={init:function(){var a,b,c,d,e=jQuery(".epsilon-color-scheme"),f=[],g={};e.length&&(a=e.find(".epsilon-color-scheme-option"),b=e.parent().find("[data-customize-setting-link]").first(),c=jQuery.parseJSON(a.first().find("input").val()),d=wp.customize,f=[],g={action:"epsilon_generate_color_scheme_css","class":"Epsilon_Color_Scheme",id:"",data:{}},jQuery.each(c,function(a,b){f.push(a)}),_.each(f,function(a){g.data[a]=d(a)(),"undefined"!=typeof d.control(a)&&d.control(a).container.on("change","input.epsilon-color-picker",_.debounce(function(){e.siblings(".epsilon-color-scheme-selected").find(".epsilon-color-scheme-palette").find('*[data-field-id="'+a+'"]').css("background",jQuery(this).attr("value")),g.data[a]=d(a)(),d.previewer.send("update-inline-color-schemes-css",g)},800))}),jQuery(".epsilon-color-scheme-option").on("click",function(){var a=jQuery(this).attr("data-color-id"),c=jQuery.parseJSON(jQuery(this).find("input").val());jQuery.each(c,function(a,b){jQuery("#customize-control-"+a+" .epsilon-color-picker").minicolors("value",b),d(a).set(b),e.siblings(".epsilon-color-scheme-selected").find(".epsilon-color-scheme-palette").find('*[data-field-id="'+a+'"]').css("background",b)}),jQuery(this).siblings(".epsilon-color-scheme-option").removeClass("selected"),jQuery(this).addClass("selected"),b.val(a).trigger("change")}),jQuery(".epsilon-control-dropdown").on("click",function(){jQuery(this).toggleClass("active"),jQuery(this).find("span").toggleClass("dashicons-arrow-down dashicons-arrow-up"),e.slideToggle()}))}},EpsilonFramework.layouts={colClasses:"col12 col11 col10 col9 col8 col7 col6 col5 col4 col3 col2 col1",html:{buttonLeft:'<a href="#" data-action="left"><span class="dashicons dashicons-arrow-left"></span> </a>',buttonRight:'<a href="#" data-action="right"><span class="dashicons dashicons-arrow-right"></span> </a>'},instance:function(a){this.context=a,this.layoutButtons=this.context.find(".epsilon-control-group > a"),this.resizeButtons=this.context.find(".epsilon-layouts-setup > .epsilon-column > a"),this.maxColumns=this.layoutButtons.length,this.minSpan=parseFloat(this.context.attr("data-min-span")),this.activeColumns=null,this.lastColumnsState=null,EpsilonFramework.layouts.handle_actions(this),this.context.on("epsilon_column_count_changed epsilon_column_size_changed",EpsilonFramework.layouts._save)},init:function(a){new EpsilonFramework.layouts.instance(jQuery(a).find(".epsilon-layouts-container"))},_save:function(a){var b={columnsCount:a.instance.activeColumns,columns:{}};jQuery.each(a.instance.context.find(".epsilon-column"),function(a){b.columns[a+1]={index:a+1,span:jQuery(this).attr("data-columns")}}),null===b.columnsCount&&(b.columnsCount=a.instance.context.find(".epsilon-column").length),a.instance.context.find("input").val(JSON.stringify(b)).trigger("change")},handle_actions:function(a){this._advanced_toggler(a),this._column_resize(a),this._column_recount(a),this._layout_select(a),this._equalize_columns(a)},_layout_select:function(a){a.layoutButtons.on("click",function(b){b.preventDefault(),jQuery(a.context).trigger({type:"epsilon_column_count_change",columns:{selected:parseFloat(jQuery(this).attr("data-button-value")),beforeSelection:a.context.find(".epsilon-layouts-setup > .epsilon-column").length}}),jQuery(this).addClass("active").siblings("a").removeClass("active")})},_column_recount:function(a){var b,c,d,e=(a.context,this);jQuery(a.context).on("epsilon_column_count_change",function(f){if(a.activeColumns=f.columns.selected,a.lastColumnsState=f.columns.beforeSelection,a.activeColumns!==a.lastColumnsState){if(b=a.lastColumnsState<a.activeColumns?"adding":"subtracting",c=a.activeColumns-a.lastColumnsState,"subtracting"===b)a.context.find(".epsilon-layouts-setup > .epsilon-column").slice(-(a.lastColumnsState-a.activeColumns)).remove();else for(d=0;c>d;d++)a.context.find(".epsilon-layouts-setup").append('<div class="epsilon-column col4">'+e.html.buttonLeft+e.html.buttonRight+"</div>");jQuery(a.context).trigger({type:"epsilon_column_count_changed",instance:a})}})},_column_resize:function(a){var b,c,d,e=this;a.context.find(".epsilon-layouts-setup").on("click",".epsilon-column > a",function(f){d=jQuery(this).parent(),b=d.index(),c="right"===jQuery(this).attr("data-action")?a.context.find(".epsilon-layouts-setup > .epsilon-column").eq(b+1):a.context.find(".epsilon-layouts-setup > .epsilon-column").eq(b-1),e.calc_column_resize(c,d,a)})},calc_column_resize:function(a,b,c){parseFloat(a.attr("data-columns"))!==c.minSpan&&(a.attr("data-columns",parseFloat(a.attr("data-columns"))-1).removeClass(this.colClasses).addClass("col"+a.attr("data-columns")),b.attr("data-columns",parseFloat(b.attr("data-columns"))+1).removeClass(this.colClasses).addClass("col"+b.attr("data-columns")),jQuery(c.context).trigger({type:"epsilon_column_size_changed",instance:c}))},_equalize_columns:function(a){var b=(a.context,this);jQuery(a.context).on("epsilon_column_count_changed",function(c){switch(a.activeColumns){case 2:a.context.find(".epsilon-column").removeClass(b.colClasses),a.context.find(".epsilon-column").first().addClass("col8").attr("data-columns",8),a.context.find(".epsilon-column").last().addClass("col4").attr("data-columns",4);break;default:a.context.find(".epsilon-column").removeClass(b.colClasses).addClass("col"+12/a.activeColumns).attr("data-columns",12/a.activeColumns)}})},_advanced_toggler:function(a){a.context.on("click",".epsilon-control-advanced",function(a){a.preventDefault(),jQuery(this).toggleClass("active"),jQuery("#"+jQuery(this).attr("data-unique-id")).slideToggle().addClass("active")})}},EpsilonFramework.repeater.base={"delete":function(a,b,c){var d,e,f,g=EpsilonFramework.repeater.base.getValue(c);g[b]&&(d=c.rows[b],d&&(delete g[b],delete c.rows[b])),g=EpsilonFramework.repeater.base.cleanArray(g),c.rows=EpsilonFramework.repeater.base.cleanArray(c.rows),jQuery.each(c.rows,function(a,b){EpsilonFramework.repeater.base.setRowIndex(b,a,c)}),EpsilonFramework.repeater.base.setValue(c,g,!0),e=1;for(f in c.rows)c.rows.hasOwnProperty(f)&&c.rows[f]&&(EpsilonFramework.repeater.base.updateLabel(c.rows[f],c),e++);c.currentIndex--},add:function(a,b){var c,d,e,f=a,g=_.memoize(EpsilonFramework.repeater.base.repeaterTemplate(f)),h=EpsilonFramework.repeater.base.getValue(f),i={};if(g){if(c=jQuery.extend(!0,{},f.params.fields),b)for(e in b)b.hasOwnProperty(e)&&c.hasOwnProperty(e)&&(c[e]["default"]=b[e]);c.index=f.currentIndex,g=g(c),d=new EpsilonFramework.repeater.row.constructor(f.currentIndex,jQuery(g).appendTo(f.repeaterContainer),f.params.rowLabel,f),d.container.on("row:remove",function(a,b){EpsilonFramework.repeater.base["delete"](this,b,f)}),d.container.on("row:update",function(a,b,c,e,f){EpsilonFramework.repeater.base.updateField.call(a,b,c,e,f),EpsilonFramework.repeater.base.updateLabel(d,f)}),d.header.on("mousedown",function(){d.container.trigger("row:start-dragging")}),f.rows[f.currentIndex]=d;for(e in c)c.hasOwnProperty(e)&&(i[e]=c[e]["default"]);return h[f.currentIndex]=i,b||EpsilonFramework.repeater.base.setValue(f,h,!0),f.currentIndex++,d}},setValue:function(a,b){a.setting.set([]),a.setting.set(b)},getValue:function(a){return a.setting.get()},updateField:function(a,b,c,d){var e,f;if(d.rows[a]&&d.params.fields[b]&&(e=d.rows[a],f=EpsilonFramework.repeater.base.getValue(d),!_.isUndefined(f[e.rowIndex][b]))){switch(d.params.fields[b].type){case"checkbox":case"epsilon-toggle":f[e.rowIndex][b]=jQuery(c).prop("checked");break;default:f[e.rowIndex][b]=jQuery(c).val()}EpsilonFramework.repeater.base.setValue(d,f)}},sort:function(a,b){var c=a.repeaterContainer.find(".repeater-row"),d=EpsilonFramework.repeater.base.getValue(a),e=[],f=[],g=[];c.each(function(a,b){e.push(jQuery(b).data("row"))}),jQuery.each(e,function(b,c){f[b]=a.rows[c],EpsilonFramework.repeater.base.setRowIndex(f[b],b,a),g[b]=d[c]}),EpsilonFramework.repeater.base.reinitTexteditor(a,b.item),a.rows=f,EpsilonFramework.repeater.base.setValue(a,g)},handleImageUpload:function(a,b){var c,d,e,f=this,g={},h=wp.media({multiple:!1}).open();h.on("select",function(){e=b.find("input"),c=h.state().get("selection").first(),d=e.attr("data-size"),"undefined"==typeof c.toJSON().sizes[d]&&(d="full"),g.id=c.id,g.url=c.toJSON().sizes[d].url,f._setImage(b,g.url),e.attr("value","url"===e.attr("data-save-mode")?g.url:g.id).trigger("change"),b.find(".actions .image-upload-remove-button").show()})},handleImageRemoval:function(a,b){var c=b.find(".epsilon-image");c.length&&c.find("img").fadeOut(200,function(){c.removeClass("epsilon-image").addClass("placeholder").html(EpsilonTranslations.selectFile)}),b.find(".actions .image-upload-remove-button").hide(),b.find("input").attr("value","").trigger("change")},_setImage:function(a,b){var c=a.find(".epsilon-image").length?a.find(".epsilon-image"):a.find(".placeholder");c.length&&(c.removeClass("epsilon-image placeholder").addClass("epsilon-image"),c.html(""),c.append('<img style="display:none" src="'+b+'" />'),c.find("img").fadeIn(200))},repeaterTemplate:function(){var a,b={evaluate:/<#([\s\S]+?)#>/g,interpolate:/\{\{\{([\s\S]+?)\}\}\}/g,escape:/\{\{([^\}]+?)\}\}(?!\})/g,variable:"data"};return function(c){return(a=_.template(jQuery(".customize-control-epsilon-repeater-content-field").html(),null,b))(c)}},setRowIndex:function(a,b,c){a.rowIndex=b,a.container.attr("data-row",b),a.container.data("row",b),EpsilonFramework.repeater.base.updateLabel(a,c)},toggleMinimize:function(a){a.container.find(".repeater-row-content").slideToggle(300,function(){a.container.toggleClass("minimized"),a.header.find(".dashicons").toggleClass("dashicons-arrow-up").toggleClass("dashicons-arrow-down")})},removeRow:function(a){a.container.slideUp(300,function(){jQuery(this).detach()}),a.container.trigger("row:remove",[a.rowIndex])},updateLabel:function(a,b){var c,d,e;return"field"===a.label.type&&(c=a.container.find('.repeater-field [data-field="'+a.label.field+'"]'),_.isFunction(c.val)&&(d=c.val(),""!==d))?(_.isUndefined(b.params.fields[a.label.field])||_.isUndefined(b.params.fields[a.label.field].type)||("select"===b.params.fields[a.label.field].type?_.isUndefined(b.params.fields[a.label.field].choices)||_.isUndefined(b.params.fields[a.label.field].choices[c.val()])||(d=b.params.fields[a.label.field].choices[c.val()]):("radio"===b.params.fields[a.label.field].type||"radio-image"===b.params.fields[a.label.field].type)&&(e=b.selector+' [data-row="'+a.rowIndex+'"] .repeater-field [data-field="'+a.label.field+'"]:checked',d=jQuery(e).val())),void a.header.find(".repeater-row-label").text(d)):void a.header.find(".repeater-row-label").text(a.label.value+" "+(a.rowIndex+1))},handleIconPickerToggle:function(a,b){b.find(".epsilon-icon-picker-container").toggleClass("opened")},handleIconPickerSelection:function(a,b,c){var d,e;c.find(".epsilon-icons > i.selected").removeClass("selected"),d=jQuery(b).addClass("selected").attr("data-icon"),d=jQuery(b).addClass("selected").attr("data-icon"),c.find(".epsilon-icon-name > i").removeClass().addClass(d),c.find(".epsilon-icon-name > .icon-label").html(e),c.find(".epsilon-icon-picker").attr("value",d).trigger("change")},handleIconPickerFiltering:function(a,b,c){var d,e,f=jQuery(c).find(".epsilon-icons > i");d=jQuery(b).val().toLowerCase(),jQuery.each(f,function(){e=jQuery(this).attr("data-search").toLowerCase(),jQuery(this)[-1!==e.indexOf(d)?"show":"hide"]()})},initTexteditor:function(a){var b,c=a.find("textarea");jQuery.each(c,function(){b=jQuery(this).attr("id"),wp.editor.initialize(b,{tinymce:{wpautop:!0,setup:function(a){a.on("change",function(b){a.save(),jQuery(a.getElement()).trigger("change")})}},quicktags:!0})})},reinitTexteditor:function(a,b){var c=b.find("textarea");jQuery.each(c,function(){wp.editor.remove(jQuery(this).attr("id")),wp.editor.initialize(jQuery(this).attr("id"),{tinymce:{wpautop:!0,setup:function(a){a.on("change",function(b){a.save(),jQuery(a.getElement()).trigger("change")})}},quicktags:!0})})},cleanArray:function(a){for(var b=[],c=0;c<a.length;c++)a[c]&&b.push(a[c]);return b}},EpsilonFramework.repeater.row={constructor:function(a,b,c,d){var e=this;this.rowIndex=a,this.container=b,this.label=c,this.header=this.container.find(".repeater-row-header"),this.header.on("click",function(){EpsilonFramework.repeater.base.toggleMinimize(e)}),this.container.on("click",".repeater-row-minimize",function(){EpsilonFramework.repeater.base.toggleMinimize(e)}),this.container.on("click",".repeater-row-remove",function(){EpsilonFramework.repeater.base.removeRow(e)}),this.container.on("keyup change","input, select, textarea",_.debounce(function(a){e.container.trigger("row:update",[e.rowIndex,jQuery(a.target).data("field"),a.target,d])},500)),EpsilonFramework.repeater.base.updateLabel(e,d)}},EpsilonFramework.sectionRepeater.base={"delete":function(a,b,c){var d,e,f,g=this,h=g.getValue(c);h[b]&&(d=c.sections[b],d&&(delete h[b],delete c.sections[b],h=EpsilonFramework.sectionRepeater.base.cleanArray(h),c.sections=EpsilonFramework.sectionRepeater.base.cleanArray(c.sections),g.setValue(c,h,!0))),jQuery.each(c.sections,function(a,b){EpsilonFramework.sectionRepeater.base.setSectionIndex(b,a,c)}),e=1;for(f in c.sections)c.sections.hasOwnProperty(f)&&c.sections[f]&&(g.updateLabel(c.sections[f],c),e++);c.currentIndex--},add:function(a,b,c){var d,e,f,g,h=this,i=_.memoize(EpsilonFramework.sectionRepeater.base.repeaterTemplate()),j=h.getValue(a),k={};if(i&&"undefined"!=typeof a.params.sections[b]){if(f=jQuery.extend(!0,{},a.params.sections[b].fields,a.params.sections[b].customization.styling,a.params.sections[b].customization.layout),d=jQuery.extend(!0,{},f,{customization:a.params.sections[b].customization}),c)for(g in c)c.hasOwnProperty(g)&&d.hasOwnProperty(g)&&(d[g]["default"]=c[g]);d.index=a.currentIndex,i=i(d),e=new EpsilonFramework.sectionRepeater.section.constructor(a.currentIndex,jQuery(i).appendTo(a.repeaterContainer),a.params.sections[b].id,a.params.sections[b].title,a),e.container.on("section:remove",function(b,c){h["delete"](this,c,a)}),e.container.on("section:update",function(a,b,c,d,f,g){h.updateField.call(a,b,c,d,f,g),h.updateLabel(e)}),a.sections[a.currentIndex]=e;for(g in d)d.hasOwnProperty(g)&&(k[g]=d[g]["default"]);return k.type=b,j[a.currentIndex]=k,c||h.setValue(a,j),a.currentIndex++,e}},handleAddButton:function(a){var b,c=this,d=jQuery("body");wp.customize.section(a.params.section,function(b){b.container.find(".accordion-section-title, .customize-section-back").on("click keydown",function(b){wp.customize.utils.isKeydownButNotEnterEvent(b)||(_.each(a.sections,function(a){a.container.hasClass("minimized")||c.toggleMinimize(a)}),d.find(".doubled-section-opened").removeClass("doubled-section-opened"))})}),a.container.find(".epsilon-add-new-section").on("click keydown",function(c){jQuery("body").hasClass("adding-doubled-section")||(b=jQuery(c.target).is(".epsilon-add-new-section"),d.toggleClass("adding-section"),d.hasClass("adding-section")&&!b&&a.close())})},setValue:function(a,b){a.setting.set([]),a.setting.set(b)},getValue:function(a){return a.setting.get()},updateLabel:function(a,b){a.header.find(".repeater-row-label").html('<span class="repeater-index">#'+(a.sectionIndex+1)+" - </span>"+a.label)},updateField:function(a,b,c,d,e){var f,g,h;if(e.sections[a]&&(f=e.sections[a],g=EpsilonFramework.sectionRepeater.base.getValue(e),d=jQuery(d),!_.isUndefined(g[f.sectionIndex][c]))){switch(h=EpsilonFramework.sectionRepeater.base.getFieldGroup(c,e,b)){case"checkbox":case"epsilon-toggle":g[f.sectionIndex][c]=d.prop("checked");break;default:g[f.sectionIndex][c]=d.val()}EpsilonFramework.sectionRepeater.base.setValue(e,g,!0)}},getFieldGroup:function(a,b,c){return b.params.sections[c].fields[a]?b.params.sections[c].fields[a].type:b.params.sections[c].customization.styling[a]?b.params.sections[c].customization.styling[a].type:b.params.sections[c].customization.layout[a]?b.params.sections[c].customization.layout[a].type:void 0},removeSection:function(a){a.container.slideUp(300,function(){jQuery(this).detach()}),a.container.trigger("section:remove",[a.sectionIndex])},repeaterTemplate:function(){var a,b={evaluate:/<#([\s\S]+?)#>/g,interpolate:/\{\{\{([\s\S]+?)\}\}\}/g,escape:/\{\{([^\}]+?)\}\}(?!\})/g,variable:"data"};return function(c){return(a=_.template(jQuery(".customize-control-epsilon-repeater-content-section").html(),null,b))(c)}},setSectionIndex:function(a,b,c){a.sectionIndex=b,a.container.attr("data-row",b),a.container.data("row",b),EpsilonFramework.sectionRepeater.base.updateLabel(a,c)},sort:function(a,b){var c=a.repeaterContainer.find(".repeater-row"),d=EpsilonFramework.sectionRepeater.base.getValue(a),e=[],f=[],g=[];c.each(function(a,b){e.push(jQuery(b).data("row"))}),jQuery.each(e,function(b,c){f[b]=a.sections[c],EpsilonFramework.sectionRepeater.base.setSectionIndex(f[b],b,a),g[b]=d[c]}),EpsilonFramework.sectionRepeater.base.reinitTexteditor(a,b.item),a.sections=f,EpsilonFramework.sectionRepeater.base.setValue(a,g)},handleImageUpload:function(a,b){var c,d,e,f=this,g={},h=wp.media({multiple:!1}).open();h.on("select",function(){e=b.find("input"),d=h.state().get("selection").first(),c=e.attr("data-size"),"undefined"==typeof d.toJSON().sizes[c]&&(c="full"),g.id=d.id,g.url=d.toJSON().sizes[c].url,f._setImage(b,g.url),e.attr("value","url"===e.attr("data-save-mode")?g.url:g.id).trigger("change"),b.find(".actions .image-upload-remove-button").show()})},handleImageRemoval:function(a,b){var c=b.find(".epsilon-image");c.length&&c.find("img").fadeOut(200,function(){c.removeClass("epsilon-image").addClass("placeholder").html(EpsilonTranslations.selectFile)}),b.find(".actions .image-upload-remove-button").hide(),b.find("input").attr("value","").trigger("change")},_setImage:function(a,b){var c=a.find(".epsilon-image").length?a.find(".epsilon-image"):a.find(".placeholder");c.length&&(c.removeClass("epsilon-image placeholder").addClass("epsilon-image"),c.html(""),c.append('<img style="display:none" src="'+b+'" />'),c.find("img").fadeIn(200))},handleIconPickerToggle:function(a,b){b.find(".epsilon-icon-picker-container").toggleClass("opened")},handleIconPickerSelection:function(a,b,c){var d,e;c.find(".epsilon-icons > i.selected").removeClass("selected"),d=jQuery(b).addClass("selected").attr("data-icon"),e=jQuery(b).addClass("selected").attr("data-search"),c.find(".epsilon-icon-name > i").removeClass().addClass(d),c.find(".epsilon-icon-name > .icon-label").html(e),c.find(".epsilon-icon-picker").attr("value",d).trigger("change")},handleIconPickerFiltering:function(a,b,c){var d,e,f=jQuery(c).find(".epsilon-icons > i");d=jQuery(b).val().toLowerCase(),jQuery.each(f,function(){e=jQuery(this).attr("data-search").toLowerCase(),jQuery(this)[-1!==e.indexOf(d)?"show":"hide"]()})},reinitTexteditor:function(a,b){var c=b.find("textarea");jQuery.each(c,function(){wp.editor.remove(jQuery(this).attr("id")),wp.editor.initialize(jQuery(this).attr("id"),{tinymce:{wpautop:!0,setup:function(a){a.on("change",function(b){a.save(),jQuery(a.getElement()).trigger("change")})}},quicktags:!0})})},initTexteditor:function(a,b){var c,d=b.find("textarea");jQuery.each(d,function(){c=jQuery(this).attr("id"),wp.editor.initialize(c,{tinymce:{wpautop:!0,setup:function(a){a.on("change",function(b){a.save(),jQuery(a.getElement()).trigger("change")})}},quicktags:!0})})},toggleMinimize:function(a){a.container.find(".repeater-row-content").slideToggle(300,function(){a.container.toggleClass("minimized"),a.header.find(".dashicons").toggleClass("dashicons-arrow-up").toggleClass("dashicons-arrow-down"),jQuery("body").removeClass("adding-section"),jQuery("body").removeClass("adding-doubled-section"),jQuery.each(a.container.siblings(),function(a,b){jQuery(b).hasClass("minimized")||(jQuery(b).addClass("minimized"),jQuery(b).find(".repeater-row-content").slideToggle(300,function(){jQuery(b).find("repeater-row-header").addClass("minimized").find(".dashicons").toggleClass("dashicons-arrow-up").toggleClass("dashicons-arrow-down")}))})})},cleanArray:function(a){for(var b=[],c=0;c<a.length;c++)a[c]&&b.push(a[c]);return b}},EpsilonFramework.sectionRepeater.section={constructor:function(a,b,c,d,e){var f=this;this.sectionIndex=a,this.container=b,this.label=d,this.type=c,this.header=this.container.find(".repeater-row-header"),jQuery(this.container).find('[data-group="regular"]').wrapAll('<div data-tab-id="regular" class="tab-panel regular active"></div>'),jQuery(this.container).find('[data-group="styling"]').wrapAll('<div data-tab-id="styling" class="tab-panel styling"></div>'),jQuery(this.container).find('[data-group="layout"]').wrapAll('<div data-tab-id="layout" class="tab-panel layout"></div>'),EpsilonFramework.sectionRepeater.section.handleTabs(this.container),this.header.on("click",function(){EpsilonFramework.sectionRepeater.base.toggleMinimize(f)}),this.container.on("click",".repeater-row-minimize",function(){EpsilonFramework.sectionRepeater.base.toggleMinimize(f)}),this.container.on("keyup change","input, select, textarea",_.debounce(function(a){f.container.trigger("section:update",[f.sectionIndex,f.type,jQuery(a.target).data("field"),a.target,e])},500)),this.container.on("click",".repeater-row-remove",function(){EpsilonFramework.sectionRepeater.base.removeSection(f)}),EpsilonFramework.sectionRepeater.base.updateLabel(f,e)},handleTabs:function(a){var b=a,c=b.find("nav"),d=b.find("[data-tab-id]"),e=c.find("a");jQuery(c).on("click",e,function(a){a.preventDefault(),d.removeClass("active"),b.find('[data-tab-id="'+jQuery(a.target).attr("data-item")+'"]').addClass("active")})}},EpsilonFramework.recommendedActions={init:function(){var a=jQuery(".control-section-epsilon-section-recommended-actions"),b=a.find(".epsilon-recommended-plugin-button"),c=a.find(".epsilon-dismiss-required-action");this.dismissActions(c),this.dismissPlugins(b),jQuery(".epsilon-close-recommended-section").on("click",function(a){a.preventDefault(),jQuery(this).find("span").toggleClass("dashicons-arrow-down-alt2"),jQuery(".recommended-actions_container").slideToggle(200)}),jQuery(document).on("epsilon-plugin-activated",function(a,b){var c=jQuery("span#"+b.plugin).parents(".epsilon-recommended-plugins"),d=c.next();c.fadeOut("200",function(){d.css({opacity:1,height:"initial"}).fadeIn("200")})})},dismissActions:function(a){a.on("click",function(){var a,b,c,d=jQuery(this),e=d.parents(".epsilon-recommended-actions-container"),f=parseInt(e.attr("data-index")),g=e.parents(".control-section-epsilon-section-recommended-actions").find("h3"),h=g.find(".epsilon-actions-count > .current-index"),i=parseInt(h.attr("data-total")),j=e.next(),k={action:["Epsilon_Notify_System","dismiss_required_action"],nonce:EpsilonWPUrls.ajax_nonce,args:{id:jQuery(this).attr("id"),option:jQuery(this).attr("data-option")}};jQuery.ajax({type:"POST",data:{action:"epsilon_framework_ajax_action",args:k},dataType:"json",url:ajaxurl,success:function(d){d.status&&"ok"===d.message&&(f>=i?(a=g.find(".section-title"),b=jQuery(".epsilon-recommended-plugins"),c=a.attr("data-social"),b.length&&(c=a.attr("data-plugin_text")),g.find(".epsilon-actions-count").remove(),a.text(c)):h.text(f+1),e.fadeOut("200",function(){j.css({opacity:1,height:"initial"}).fadeIn("200")}))},error:function(a,b,c){console.log(a+" :: "+b+" :: "+c)}})})},dismissPlugins:function(a){a.on("click",function(){var a,b,c=jQuery(this),d=c.parents(".epsilon-recommended-plugins"),e=d.next(),f=d.parents(".control-section-epsilon-section-recommended-actions").find("h3"),g={action:["Epsilon_Notify_System","dismiss_required_action"],nonce:EpsilonWPUrls.ajax_nonce,args:{id:jQuery(this).attr("id"),option:jQuery(this).attr("data-option")}};jQuery.ajax({type:"POST",data:{action:"epsilon_framework_ajax_action",args:g},dataType:"json",url:ajaxurl,success:function(c){c.status&&"ok"===c.message&&d.fadeOut("200",function(){e.is("p")&&(a=f.find(".section-title"),b=a.attr("data-social"),a.text(b)),e.css({opacity:1,height:"initial"}).fadeIn("200")})},error:function(a,b,c){console.log(a+" :: "+b+" :: "+c)}})})}},EpsilonFramework.sectionDoubled={section:null,parent:null,init:function(a){this.section=a,this.createParent(),a.container.appendTo(this.parent),this.handleEvents()},createParent:function(){var a=jQuery(".wp-full-overlay").find(".doubled-section-parent");a.length||(jQuery(".wp-full-overlay").append('<div class="doubled-section-parent"></div>'),a=jQuery(".wp-full-overlay").find(".doubled-section-parent"),this.parent=a),this.parent=a},handleEvents:function(){var a=this.section,b=this;this.section.container.on("click",".epsilon-close-doubled-section",function(a){a.preventDefault(),jQuery("body").removeClass("adding-doubled-section"),jQuery("body").find(".doubled-section-opened").removeClass("doubled-section-opened")}),this.section.headContainer.on("click",function(c){var d,e,f;c.preventDefault(),jQuery("body").hasClass("adding-section")||(d=b.parent.find(".doubled-section-opened"),d.length&&d.removeClass("doubled-section-opened"),jQuery("body").hasClass("adding-doubled-section")?(e=jQuery(this).attr("id").replace("accordion-section-",""),f=d.attr("id").replace("sub-accordion-section-",""),f===e&&jQuery("body").removeClass("adding-doubled-section")):jQuery("body").toggleClass("adding-doubled-section"),jQuery.each(a.container,function(a){jQuery(this).is("li")||jQuery(this).addClass("doubled-section-opened")}))})}},wp.customize.controlConstructor["epsilon-color-scheme"]=wp.customize.Control.extend({ready:function(){var a=this;jQuery(this.container).find(".epsilon-color-scheme-input").on("change",function(){a.setting.set(jQuery(this).val())})}}),wp.customize.controlConstructor["epsilon-layouts"]=wp.customize.Control.extend({ready:function(){var a=this;EpsilonFramework.layouts.init(this.container),jQuery(this.container).find("input").on("change",function(){a.setting.set(jQuery(this).val())})}}),wp.customize.controlConstructor["epsilon-repeater"]=wp.customize.Control.extend({ready:function(){this.initRepeater()},initRepeater:function(){this.settingField=this.container.find("[data-customize-setting-link]").first(),this.repeaterContainer=this.container.find(".repeater-fields").first(),this.currentIndex=0,this.rows=[],this.handleEvents(),this.initIconPicker(),this.initImageControls(),this.createExistingRows(),this.initSortable()},createExistingRows:function(){var a,b=this;this.params.value.length&&_.each(this.params.value,function(c){a=EpsilonFramework.repeater.base.add(b,c),EpsilonFramework.repeater.base.initTexteditor(a.container)})},handleEvents:function(){var a,b=this,c=!1;_.isUndefined(this.params.choices.limit)||(c=0>=this.params.choices.limit?!1:parseInt(this.params.choices.limit)),this.container.on("click","button.epsilon-repeater-add",function(d){d.preventDefault(),!c||b.currentIndex<c?(a=EpsilonFramework.repeater.base.add(b),EpsilonFramework.repeater.base.initTexteditor(a.container)):jQuery(b.selector+" .limit").addClass("highlight")}),this.container.on("click",".repeater-row-remove",function(){b.currentIndex--,(!c||b.currentIndex<c)&&jQuery(b.selector+" .limit").removeClass("highlight")})},initImageControls:function(){var a,b=this;this.container.on("click keypress",".epsilon-controller-image-container .image-upload-button",function(c){c.preventDefault(),wp.customize.utils.isKeydownButNotEnterEvent(c)||(a=jQuery(this).parents(".epsilon-controller-image-container"),EpsilonFramework.repeater.base.handleImageUpload(b,a))}),this.container.on("click keypress",".epsilon-controller-image-container .image-upload-remove-button",function(c){c.preventDefault(),wp.customize.utils.isKeydownButNotEnterEvent(c)||(a=jQuery(this).parents(".epsilon-controller-image-container"),EpsilonFramework.repeater.base.handleImageRemoval(b,a))})},initSortable:function(){var a=this;this.repeaterContainer.sortable({handle:".repeater-row-header",axis:"y",distance:15,update:function(b,c){EpsilonFramework.repeater.base.sort(a,c)}})},initIconPicker:function(){var a,b=this;this.container.on("click keypress",".epsilon-icon-picker-repeater-container .epsilon-open-icon-picker",function(c){c.preventDefault(),wp.customize.utils.isKeydownButNotEnterEvent(c)||(jQuery(this).toggleClass("opened-icon-picker"),a=jQuery(this).parents(".epsilon-icon-picker-repeater-container"),EpsilonFramework.repeater.base.handleIconPickerToggle(b,a))}),this.container.on("click keypress",".epsilon-icon-picker-repeater-container .epsilon-icons-container .epsilon-icons > i",function(c){c.preventDefault(),wp.customize.utils.isKeydownButNotEnterEvent(c)||(a=jQuery(this).parents(".epsilon-icon-picker-repeater-container"),EpsilonFramework.repeater.base.handleIconPickerSelection(b,this,a))}),this.container.on("keyup change",".epsilon-icon-picker-repeater-container .search-container input",_.debounce(function(c){c.preventDefault(),wp.customize.utils.isKeydownButNotEnterEvent(c)||(a=jQuery(this).parents(".epsilon-icon-picker-repeater-container"),EpsilonFramework.repeater.base.handleIconPickerFiltering(b,this,a))},1e3))}}),wp.customize.controlConstructor["epsilon-section-repeater"]=wp.customize.Control.extend({ready:function(){var a=this;jQuery("#sections-left-"+this.params.id).appendTo(jQuery(".wp-full-overlay")),this.initSearch(this,jQuery("#sections-left-"+this.params.id)),this.settingField=this.container.find("[data-customize-setting-link]").first(),this.repeaterContainer=this.container.find(".repeater-sections").first(),this.currentIndex=0,this.sections=[],this.handleEvents(),this.initIconPicker(),this.initImageControls(),this.createExistingSections(),this.params.sortable&&this.initSortable(),wp.customize.previewer.bind("epsilon-section-edit",function(b){return"undefined"==typeof wp.customize.section(b.customizerSection)?!1:(_.each(a.sections,function(a,c){a.container.hasClass("minimized")||c===b.section||EpsilonFramework.sectionRepeater.base.toggleMinimize(a)}),wp.customize.section(b.customizerSection).focus(),void(!_.isUndefined(a.sections[b.section])&&a.sections[b.section].container.hasClass("minimized")&&EpsilonFramework.sectionRepeater.base.toggleMinimize(a.sections[b.section])))})},handleEvents:function(){var a,b=this,c=!1;EpsilonFramework.sectionRepeater.base.handleAddButton(this),_.isUndefined(this.params.choices.limit)||(c=0>=this.params.choices.limit?!1:parseInt(this.params.choices.limit)),jQuery("#sections-left-"+this.params.id).on("click",".epsilon-section",function(d){d.preventDefault(),!c||b.currentIndex<c?(a=EpsilonFramework.sectionRepeater.base.add(b,jQuery(this).attr("data-id")),jQuery("body").removeClass("adding-section"),EpsilonFramework.sectionRepeater.base.initTexteditor(b,a.container),a.container.find(".epsilon-selectize").selectize({plugins:["remove_button"]})):jQuery(b.selector+" .limit").addClass("highlight")})},createExistingSections:function(){var a,b=this;this.params.value.length&&_.each(this.params.value,function(c){a=EpsilonFramework.sectionRepeater.base.add(b,c.type,c),"undefined"!=typeof a&&(EpsilonFramework.sectionRepeater.base.initTexteditor(b,a.container),a.container.find(".epsilon-selectize").selectize({plugins:["remove_button"]}))})},initSortable:function(){var a=this;this.repeaterContainer.sortable({handle:".repeater-row-header",axis:"y",distance:15,update:function(b,c){EpsilonFramework.sectionRepeater.base.sort(a,c)}})},initImageControls:function(){var a,b=this;this.container.on("click keypress",".epsilon-controller-image-container .image-upload-button",function(c){c.preventDefault(),wp.customize.utils.isKeydownButNotEnterEvent(c)||(a=jQuery(this).parents(".epsilon-controller-image-container"),EpsilonFramework.sectionRepeater.base.handleImageUpload(b,a))}),this.container.on("click keypress",".epsilon-controller-image-container .image-upload-remove-button",function(c){c.preventDefault(),wp.customize.utils.isKeydownButNotEnterEvent(c)||(a=jQuery(this).parents(".epsilon-controller-image-container"),
EpsilonFramework.sectionRepeater.base.handleImageRemoval(b,a))})},initSearch:function(a,b){var c,d,e,f=b.find(".sections-search-input");f.on("keyup change",_.debounce(function(a){c=f.val().toLowerCase(),d=b.find(".epsilon-section"),jQuery.each(d,function(){e=jQuery(this).attr("data-id").toLowerCase(),jQuery(this)[-1!==e.indexOf(c)?"show":"hide"]()})},1e3))},initIconPicker:function(){var a,b=this;this.container.on("click keypress",".epsilon-icon-picker-repeater-container .epsilon-open-icon-picker",function(c){c.preventDefault(),wp.customize.utils.isKeydownButNotEnterEvent(c)||(jQuery(this).toggleClass("opened-icon-picker"),a=jQuery(this).parents(".epsilon-icon-picker-repeater-container"),EpsilonFramework.sectionRepeater.base.handleIconPickerToggle(b,a))}),this.container.on("click keypress",".epsilon-icon-picker-repeater-container .epsilon-icons-container .epsilon-icons > i",function(c){c.preventDefault(),wp.customize.utils.isKeydownButNotEnterEvent(c)||(a=jQuery(this).parents(".epsilon-icon-picker-repeater-container"),EpsilonFramework.sectionRepeater.base.handleIconPickerSelection(b,this,a))}),this.container.on("keyup change",".epsilon-icon-picker-repeater-container .search-container input",_.debounce(function(c){c.preventDefault(),wp.customize.utils.isKeydownButNotEnterEvent(c)||(a=jQuery(this).parents(".epsilon-icon-picker-repeater-container"),EpsilonFramework.sectionRepeater.base.handleIconPickerFiltering(b,this,a))},1e3))}}),wp.customize.controlConstructor["epsilon-upsell"]=wp.customize.Control.extend({ready:function(){var a=this;a.container.on("click",".epsilon-upsell-label",function(b){b.preventDefault(),jQuery(this).toggleClass("opened").find("i").toggleClass("dashicons-arrow-down-alt2 dashicons-arrow-up-alt2"),a.container.find(".epsilon-upsell-container").slideToggle(200)})}}),wp.customize.panelConstructor["epsilon-panel-regular"]=wp.customize.Panel.extend({_panelEmbed:wp.customize.Panel.prototype.embed,_panelIsContextuallyActive:wp.customize.Panel.prototype.isContextuallyActive,_panelAttachEvents:wp.customize.Panel.prototype.attachEvents,ready:function(){this.params.hidden&&this.container.addClass("epsilon-hidden"),wp.customize.bind("pane-contents-reflowed",function(){var a=[];wp.customize.panel.each(function(b){"epsilon-panel-regular"===b.params.type&&"undefined"!=typeof b.params.panel&&a.push(b)}),a.sort(wp.customize.utils.prioritySort).reverse(),jQuery.each(a,function(a,b){var c=jQuery("#sub-accordion-panel-"+b.params.panel);c.children(".panel-meta").after(b.headContainer)}),jQuery(document).trigger("epsilon-reflown-panels")})},attachEvents:function(){var a=this;return"epsilon-panel-regular"!==this.params.type||"undefined"==typeof this.params.panel?void this._panelAttachEvents.call(this):(this._panelAttachEvents.call(this),a.expanded.bind(function(b){var c=wp.customize.panel(a.params.panel);b?c.contentContainer.addClass("current-panel-parent"):c.contentContainer.removeClass("current-panel-parent")}),void a.container.find(".customize-panel-back").off("click keydown").on("click keydown",function(b){wp.customize.utils.isKeydownButNotEnterEvent(b)||(b.preventDefault(),a.expanded()&&wp.customize.panel(a.params.panel).expand())}))},isContextuallyActive:function(){var a=this,b=this._children("panel","section"),c=0;return"epsilon-panel-regular"!==this.params.type?this._panelIsContextuallyActive.call(this):(wp.customize.panel.each(function(c){c.params.panel&&c.params.panel===a.id&&b.push(c)}),b.sort(wp.customize.utils.prioritySort),_(b).each(function(a){a.active()&&a.isContextuallyActive()&&(c+=1)}),0!==c)},embed:function(){var a=this,b=jQuery("#sub-accordion-panel-"+this.params.panel);return"epsilon-panel-regular"!==this.params.type||"undefined"==typeof this.params.panel?void this._panelEmbed.call(this):(this._panelEmbed.call(this),void b.append(a.headContainer))}}),wp.customize.sectionConstructor["epsilon-section-recommended-actions"]=wp.customize.Section.extend({ready:function(){EpsilonFramework.recommendedActions.init()},attachEvents:function(){},isContextuallyActive:function(){return!0}}),wp.customize.sectionConstructor["epsilon-section-doubled"]=wp.customize.Section.extend({ready:function(){EpsilonFramework.sectionDoubled.init(this)},attachEvents:function(){},isContextuallyActive:function(){return!0}}),wp.customize.sectionConstructor["epsilon-section-pro"]=wp.customize.Section.extend({attachEvents:function(){},isContextuallyActive:function(){return!0}}),jQuery(document).on("widget-updated widget-added",function(a,b){jQuery().slider}),wp.customize.bind("ready",function(){EpsilonFramework.colorSchemes.init()});